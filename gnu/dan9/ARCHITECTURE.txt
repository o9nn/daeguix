```
┌──────────────────────────────────────────────────────────────────────────────┐
│                          DAN9 ARCHITECTURE                                   │
│                     "Everything is a Daemon"                                 │
└──────────────────────────────────────────────────────────────────────────────┘

┌──────────────────────────────────────────────────────────────────────────────┐
│                        CORE INFRASTRUCTURE                                   │
├──────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  ┌─────────────────────────────────────────────────────────┐                │
│  │           Daemon Infrastructure (daemons.scm)           │                │
│  ├─────────────────────────────────────────────────────────┤                │
│  │  • Lifecycle Management (create, start, stop)           │                │
│  │  • Message Passing (mailboxes, send, receive)           │                │
│  │  • Global Registry (lookup, list)                       │                │
│  │  • Metrics Collection (counters, timestamps)            │                │
│  │  • Thread Safety (mutexes, atomic operations)           │                │
│  └─────────────────────────────────────────────────────────┘                │
│                                                                              │
└──────────────────────────────────────────────────────────────────────────────┘

┌──────────────────────────────────────────────────────────────────────────────┐
│                          CORE DAEMONS                                        │
├──────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  ┌────────────────┐  ┌────────────────┐  ┌────────────────┐                │
│  │  Filesystem    │  │    Network     │  │    Process     │                │
│  │    Daemon      │  │    Daemon      │  │    Daemon      │                │
│  ├────────────────┤  ├────────────────┤  ├────────────────┤                │
│  │ • read         │  │ • connect      │  │ • spawn        │                │
│  │ • write        │  │ • send         │  │ • kill         │                │
│  │ • list         │  │ • receive      │  │ • wait         │                │
│  │ • stat         │  │ • listen       │  │ • list         │                │
│  │ • mkdir        │  │ • disconnect   │  │ • getpid       │                │
│  └────────────────┘  └────────────────┘  └────────────────┘                │
│                                                                              │
│  ┌────────────────────────────────────────────────────────┐                 │
│  │              Namespace Daemon                          │                 │
│  ├────────────────────────────────────────────────────────┤                 │
│  │  • bind/unbind    • lookup    • mount/unmount          │                 │
│  └────────────────────────────────────────────────────────┘                 │
│                                                                              │
└──────────────────────────────────────────────────────────────────────────────┘

┌──────────────────────────────────────────────────────────────────────────────┐
│                    EGREGORE: DAEMON ORCHESTRATION                            │
├──────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  ┌──────────────────────────────────────────────────────────────────────┐   │
│  │                    Egregore (egregore.scm)                           │   │
│  │              "Collective Daemon Consciousness"                       │   │
│  └──────────────────────────────────────────────────────────────────────┘   │
│                                                                              │
│  ┌─────────────────┐ ┌─────────────────┐ ┌─────────────────┐               │
│  │  SWARM          │ │  HIERARCHY      │ │  RING           │               │
│  │  Archetype      │ │  Archetype      │ │  Archetype      │               │
│  ├─────────────────┤ ├─────────────────┤ ├─────────────────┤               │
│  │                 │ │   Coordinator   │ │   D1 ──> D2     │               │
│  │  D1   D2   D3   │ │    /  |  \      │ │    ^      |     │               │
│  │   \   |   /     │ │   /   |   \     │ │    |      v     │               │
│  │    Broadcast    │ │  W1  W2  W3     │ │   D4 <── D3     │               │
│  │                 │ │                 │ │                 │               │
│  │ • Parallel      │ │ • Delegation    │ │ • Pipeline      │               │
│  │ • Worker pool   │ │ • Tree tasks    │ │ • Token pass    │               │
│  └─────────────────┘ └─────────────────┘ └─────────────────┘               │
│                                                                              │
│  ┌─────────────────────────────────────────────────────────┐                │
│  │  MESH Archetype                                         │                │
│  ├─────────────────────────────────────────────────────────┤                │
│  │       D1 ←──────→ D2                                    │                │
│  │        ↑  ╲     ╱  ↑                                    │                │
│  │        |   ╲   ╱   |                                    │                │
│  │        |    ╲ ╱    |                                    │                │
│  │        |     ╳     |                                    │                │
│  │        |    ╱ ╲    |                                    │                │
│  │        ↓   ╱   ╲   ↓                                    │                │
│  │       D3 ←──────→ D4                                    │                │
│  │                                                         │                │
│  │  • Fully connected  • Consensus  • P2P                  │                │
│  └─────────────────────────────────────────────────────────┘                │
│                                                                              │
└──────────────────────────────────────────────────────────────────────────────┘

┌──────────────────────────────────────────────────────────────────────────────┐
│              ANTIKYTHERA: NESTED EVENT LOOP SCHEDULER                        │
├──────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  ┌──────────────────────────────────────────────────────────────────────┐   │
│  │              Antikythera Mechanism (antikythera.scm)                 │   │
│  │            "Time-Scaled Nested Event Loops"                          │   │
│  └──────────────────────────────────────────────────────────────────────┘   │
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────┐        │
│  │                    Gear Hierarchy                               │        │
│  │                                                                 │        │
│  │   ┌──────────────────────────────────────────────────┐          │        │
│  │   │  Year Gear (Ratio: 365)                          │          │        │
│  │   │  ┌────────────────────────────────────────┐      │          │        │
│  │   │  │  Day Gear (Ratio: 24)                  │      │          │        │
│  │   │  │  ┌──────────────────────────────┐      │      │          │        │
│  │   │  │  │  Hour Gear (Ratio: 60)       │      │      │          │        │
│  │   │  │  │  ┌────────────────────┐      │      │      │          │        │
│  │   │  │  │  │ Minute Gear (1)    │      │      │      │          │        │
│  │   │  │  │  │                    │      │      │      │          │        │
│  │   │  │  │  │  • Base tick       │      │      │      │          │        │
│  │   │  │  │  │  • Events fire     │      │      │      │          │        │
│  │   │  │  │  └────────────────────┘      │      │      │          │        │
│  │   │  │  │  60 ticks = 1 parent tick    │      │      │          │        │
│  │   │  │  └──────────────────────────────┘      │      │          │        │
│  │   │  │  24 ticks = 1 parent tick              │      │          │        │
│  │   │  └────────────────────────────────────────┘      │          │        │
│  │   │  365 ticks = 1 parent tick                       │          │        │
│  │   └──────────────────────────────────────────────────┘          │        │
│  │                                                                 │        │
│  │   Time Scaling:                                                 │        │
│  │   • 100ms base tick → 1 simulated minute                        │        │
│  │   • 6 seconds → 1 simulated hour                                │        │
│  │   • 2.4 minutes → 1 simulated day                               │        │
│  │   • 14.6 hours → 1 simulated year                               │        │
│  └─────────────────────────────────────────────────────────────────┘        │
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────┐        │
│  │  Event Registration                                             │        │
│  ├─────────────────────────────────────────────────────────────────┤        │
│  │  • Register events on any gear                                  │        │
│  │  • Events fire at tick intervals                                │        │
│  │  • Callbacks executed in scheduler thread                       │        │
│  │  • Example: (register-event! day-gear "weekly" 7 callback)      │        │
│  └─────────────────────────────────────────────────────────────────┘        │
│                                                                              │
└──────────────────────────────────────────────────────────────────────────────┘

┌──────────────────────────────────────────────────────────────────────────────┐
│                    INTEGRATION: EGREGORE + ANTIKYTHERA                       │
├──────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  ┌──────────────────────────────────────────────────────────────────┐       │
│  │  Time-Triggered Daemon Orchestration                             │       │
│  └──────────────────────────────────────────────────────────────────┘       │
│                                                                              │
│           Antikythera Scheduler                                              │
│                  │                                                           │
│                  │  Time Events                                              │
│                  ├────────────────┐                                          │
│                  │                │                                          │
│                  v                v                                          │
│            ┌──────────┐     ┌──────────┐                                     │
│            │  Swarm   │     │Hierarchy │                                     │
│            │Egregore  │     │Egregore  │                                     │
│            └──────────┘     └──────────┘                                     │
│                  │                │                                          │
│                  │  Orchestrate   │                                          │
│                  v                v                                          │
│            ┌──────────────────────────┐                                      │
│            │   Worker Daemons         │                                      │
│            │   D1  D2  D3  D4  D5     │                                      │
│            └──────────────────────────┘                                      │
│                                                                              │
│  Example Flow:                                                               │
│  1. Minute gear ticks → Trigger worker swarm                                 │
│  2. Hour gear ticks → Status update                                          │
│  3. Day gear ticks → Daily coordinator aggregates                            │
│  4. Week gear ticks → Weekly reporter generates reports                      │
│  5. Year gear ticks → Yearly archiver archives data                          │
│                                                                              │
└──────────────────────────────────────────────────────────────────────────────┘

┌──────────────────────────────────────────────────────────────────────────────┐
│                          MESSAGE FLOW                                        │
├──────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  Sender Daemon                                                               │
│       │                                                                      │
│       │  daemon-send-message(sender, recipient, type, payload)              │
│       │                                                                      │
│       v                                                                      │
│  ┌──────────────────────────────────────┐                                    │
│  │  Message: <daemon-message>           │                                    │
│  │  • sender: "daemon-1"                │                                    │
│  │  • recipient: "daemon-2"             │                                    │
│  │  • type: 'process                    │                                    │
│  │  • payload: ((data . "..."))         │                                    │
│  │  • timestamp: <time>                 │                                    │
│  └──────────────────────────────────────┘                                    │
│       │                                                                      │
│       │  mailbox-send!                                                       │
│       │                                                                      │
│       v                                                                      │
│  Recipient Mailbox (mutex-protected queue)                                   │
│       │                                                                      │
│       │  daemon-receive-message                                              │
│       │                                                                      │
│       v                                                                      │
│  Recipient Daemon Loop                                                       │
│       │                                                                      │
│       │  handle-message                                                      │
│       │                                                                      │
│       v                                                                      │
│  Process & Respond                                                           │
│                                                                              │
└──────────────────────────────────────────────────────────────────────────────┘

┌──────────────────────────────────────────────────────────────────────────────┐
│                            PHILOSOPHY                                        │
├──────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  Dan9 Core:                  "Everything is a daemon"                        │
│                                                                              │
│  Egregore Extension:         "Daemons gain power through coordination"      │
│                                                                              │
│  Antikythera Extension:      "Time becomes fluid through nested loops"      │
│                                                                              │
│  Like Plan9's uniform file interface, Dan9 provides uniform daemon           │
│  interface. Egregores add collective intelligence. Antikythera adds          │
│  temporal intelligence.                                                      │
│                                                                              │
│  Together: A living, breathing system that coordinates across space          │
│  (egregores) and time (antikythera).                                         │
│                                                                              │
└──────────────────────────────────────────────────────────────────────────────┘
```
